<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="      sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</head>
<body>

<br>
    <div class='container'>
    <form>
        <div class="form-group">
            <span class="heading" >Enter order id</span>
            <input class="form-control form-control-sm" type="text" id='input'>
        </div>
        <div class='text-center'>
            <button class='btn btn-warning' type='button' onclick='generate()'>Generate</button>
        </div>
    </form>
    </div>
    <br>
    <p class='text-center'>Value of P is : <span id='pvalue'></span></p>
    <p class='text-center'>Value of Q is : <span id='qvalue'></span></p>

</body>
<script>

function generateOrderId() {
    var s= (new Date()).getTime();
    document.getElementById('input').value = s;
}

function generate(){
   
    document.getElementById('pvalue').innerHTML='';
    document.getElementById('qvalue').innerHTML='';
    var num = 0;var final = 0;
    var value = 0;var prime = 0;var result= 0 ;var ans=0;
    localStorage.setItem('value',0);

    function toBinary(n){
        var array=[]; var array2=[];
        var i = 0; 
        while (n > 0) { 
            array[i] = n % 2; 
            n = Math.floor(n / 2); 
            i++; 
        }
        var k=0;
        for (var j = i - 1; j >= 0; j--) {
            array2[k] = array[j];
            k++;
    } 
        return array2;
    }

    function isPrime(num){
        var i,flag=0;
        for(i=2; i <= num/2; i++){
            if(num%i == 0){
                flag = 1;
                break;
            }
        }
            if(flag==0)
                final=num;
            else
                isPrime(num+1);
                
            return final;
    }

    function count(answer){
        var count=0;
        for(var m=0;m<answer.length;m++){
            if(answer[m]==1){count++};
        }
        return count;
    } 

    function findPrimefactors (num) {
        var primeFactors = [];
        while (num % 2 === 0) {
            primeFactors.push(2);
            num = num / 2;
        }
        var sqrtNum = Math.sqrt(num);
        for (var i = 3; i <= sqrtNum; i++) {
            while (num % i === 0) {
                primeFactors.push(i);
                num = num / i;
            }
        }

        if (num > 2) {
            primeFactors.push(num);
        }
        return primeFactors;
    }

    function power(x,y,p){
        var res = 1;
        x=x%p;
        while(y>0){
            if(y & 1)
                {res = (res*x)%p;}
        
        y = y/2;
        x=(x*x)%p;
        }
        if(res==1)
        return 1;
        else
        return 0;
    }

    function findPrimitive(n){
        var powers=[];
        var phi = n-1;
        var array= findPrimefactors(phi);
        for(var f=0;f<array.length;f++){
        powers[f] = phi/array[f];
        }
        for (var r=2; r<=phi; r++) 
        {
            c=0;
            for(var nn=0;nn<powers.length;nn++){
                if(power(r, powers[nn], n) == 1 ){
                    c=1;
                }
            }
            if(c==0) return r;

        }
    }
    generateOrderId();
    var answer = toBinary(Number(document.getElementById('input').value));
    var prime = count(answer);
    var ans = isPrime(prime);
    localStorage.setItem('value',ans);
    var result = findPrimitive(localStorage.getItem('value'));
    document.getElementById('pvalue').innerHTML=ans;
    document.getElementById('qvalue').innerHTML=result;
}

</script>
</html>
